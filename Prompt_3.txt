ROLE: You are an AI agent tasked with taking financial data and being a top-level financial analyst, converting PDFs into a structured JSON format that represents a series of presentation slides.
STEP 1: DOCUMENT EXTRACTION AND GLOBAL ANALYSIS
For the entire PDF, perform the following actions:
Extract raw data, content, and visual elements.
Create a metadata object containing the overall document title, company name, and reporting period.
Identify recurring styles for text and containers. Define these in a styleguide.classes object. For example, create classes for titles (titleText), body copy (bodyText), and KPI boxes (kpiBox).
STEP 2: SLIDE PROCESSING AND ANALYSIS
For each slide in the PDF:
Assign a unique, descriptive slideId (max 10 characters).
Write a description object summarizing the content. Instead of a 'crux', provide an insight field: a single sentence explaining the key financial takeaway or business implication of the slide.
Focus on financial metrics, KPIs, trends, and data insights.
STEP 3: SLIDE ELEMENT STRUCTURING
Interpret and structure all elements on the slide. Each element must be a JSON object with the following properties:
MANDATORY PROPERTIES FOR ALL ELEMENTS:
id: Unique identifier (max 10 characters).
type: "image" or "text".
x, y, w, h: Position and dimensions in pixels.
opacity: 0.0 to 1.0.
class (Optional): A string referencing a class from the styleguide (e.g., "titleText").
styling: An object containing all visual styles. This can be used to override or supplement styles from a class.
backgroundColor, border, borderRadius, padding
fontFamily, fontSize, fontWeight, fontStyle, color, textAlign, lineHeight (for text elements).
SPECIFIC RULES FOR TEXT ELEMENTS:
Must include a content property with the text string.
All styling (font, color, etc.) must go inside the styling object.
SPECIFIC RULES FOR IMAGE ELEMENTS (CHARTS, TABLES, LOGOS):
Must include an imageUrl property, which is the filename of the extracted raw visual from the slide (e.g., "slide2-chart1.png").
If the image is a chart or table, attempt to deconstruct it into chartData or tableData.
You MUST include a dataExtraction object with:
status: Set to "success" if data was fully extracted, "partial" if there are uncertainties, and "failed" if the data could not be read.
confidence: Your confidence score (0.0 to 1.0) in the accuracy of the extracted data.
error: A brief explanation if the status is "failed" (e.g., "3D pie chart not supported").
The chartData or tableData object should only be included if the status is "success" or "partial".
FINAL JSON STRUCTURE:
The final output must be a single JSON object with the root key presentation. This object contains metadata, styleguide, and a list of slides.

Sample Json structure to be used as reference
{
  "presentation": {
    "metadata": {
      "documentTitle": "Q4 & FY2025 Financial Results",
      "company": "Global Tech Inc.",
      "reportingPeriod": "Q4 & Full Year 2025",
      "generatedAt": "2023-10-27T10:00:00Z"
    },
    "styleguide": {
      "classes": {
        "pageTitle": {
          "fontFamily": "Inter, Arial, sans-serif",
          "fontSize": "32pt",
          "fontWeight": "bold",
          "color": "#0D1A2E"
        },
        "kpiBox": {
          "backgroundColor": "#F0F4F7",
          "borderRadius": "12px",
          "padding": "20px"
        },
        "kpiValue": {
          "fontFamily": "Inter, Arial, sans-serif",
          "fontSize": "28pt",
          "fontWeight": "bold",
          "color": "#005F88",
          "textAlign": "center"
        },
        "kpiLabel": {
          "fontFamily": "Inter, Arial, sans-serif",
          "fontSize": "14pt",
          "color": "#5A6878",
          "textAlign": "center"
        }
      },
      "defaultStyles": {
        "text": {
          "fontFamily": "Inter, Arial, sans-serif",
          "fontSize": "12pt",
          "color": "#333333"
        },
        "image": {
          "backgroundColor": "transparent"
        }
      }
    },
    "slides": [
      {
        "slideId": "s01_title",
        "description": {
          "summary": "This is the main title slide for the Q4 and Full Year 2025 financial results presentation for Global Tech Inc.",
          "insight": "The presentation will detail a period of significant growth and strategic execution for the company."
        },
        "elements": [
          {
            "id": "s1-logo",
            "type": "image",
            "x": 100,
            "y": 80,
            "w": 180,
            "h": 45,
            "opacity": 1.0,
            "imageUrl": "s1-logo.png",
            "styling": {}
          },
          {
            "id": "s1-title",
            "type": "text",
            "content": "Q4 & Full Year 2025 Financial Results",
            "x": 100,
            "y": 450,
            "w": 1200,
            "h": 100,
            "opacity": 1.0,
            "class": "pageTitle",
            "styling": {
              "fontSize": "54pt"
            }
          },
          {
            "id": "s1-date",
            "type": "text",
            "content": "October 27, 2025",
            "x": 100,
            "y": 560,
            "w": 800,
            "h": 50,
            "opacity": 1.0,
            "styling": {
              "fontFamily": "Inter, Arial, sans-serif",
              "fontSize": "24pt",
              "color": "#5A6878"
            }
          }
        ]
      },
      {
        "slideId": "s02_kpis",
        "description": {
          "summary": "This slide provides a high-level dashboard of Key Performance Indicators (KPIs) for the full fiscal year.",
          "insight": "The company shows strong, double-digit YoY growth across revenue and profit, coupled with significant margin expansion, indicating operational efficiency."
        },
        "elements": [
          {
            "id": "s2-title",
            "type": "text",
            "content": "FY2025 Financial Highlights",
            "x": 100,
            "y": 80,
            "w": 800,
            "h": 50,
            "opacity": 1.0,
            "class": "pageTitle",
            "styling": {}
          },
          {
            "id": "s2-kpi1bg",
            "type": "image",
            "x": 100, "y": 200, "w": 400, "h": 200,
            "opacity": 1.0, "class": "kpiBox",
            "imageUrl": "s2-kpi-background.png",
            "styling": {}
          },
          {
            "id": "s2-kpi1tx",
            "type": "text",
            "content": "Total Revenue\n$5.2B\n+15% YoY",
            "x": 100, "y": 220, "w": 400, "h": 160,
            "opacity": 1.0,
            "styling": { "fontFamily": "Inter", "fontSize": "24pt", "lineHeight": 1.4, "textAlign": "center", "color": "#0D1A2E"}
          },
          {
            "id": "s2-kpi2bg",
            "type": "image",
            "x": 550, "y": 200, "w": 400, "h": 200,
            "opacity": 1.0, "class": "kpiBox",
            "imageUrl": "s2-kpi-background.png",
            "styling": {}
          },
          {
            "id": "s2-kpi2tx",
            "type": "text",
            "content": "Net Profit\n$850M\n+22% YoY",
            "x": 550, "y": 220, "w": 400, "h": 160,
            "opacity": 1.0,
            "styling": { "fontFamily": "Inter", "fontSize": "24pt", "lineHeight": 1.4, "textAlign": "center", "color": "#0D1A2E"}
          }
        ]
      },
      {
        "slideId": "s03_chart",
        "description": {
          "summary": "This slide visualizes the quarterly revenue trend over the last two fiscal years, showing growth.",
          "insight": "Revenue growth is accelerating, with Q4 showing the strongest performance, suggesting strong market momentum heading into the next fiscal year."
        },
        "elements": [
          {
            "id": "s3-chart1",
            "type": "image",
            "x": 100, "y": 150, "w": 1720, "h": 800,
            "opacity": 1.0,
            "imageUrl": "s3-chart-revenue.png",
            "dataExtraction": {
              "status": "success",
              "confidence": 0.98,
              "error": null
            },
            "chartData": {
              "chartType": "bar",
              "title": "Quarterly Revenue Growth (in $M)",
              "xAxis": {
                "label": "Fiscal Quarter",
                "categories": ["Q1'24", "Q2'24", "Q3'24", "Q4'24", "Q1'25", "Q2'25", "Q3'25", "Q4'25"]
              },
              "yAxis": {
                "label": "Revenue ($M)",
                "prefix": "$"
              },
              "series": [
                {
                  "name": "Revenue",
                  "color": "#005f88",
                  "data": [950, 1050, 1100, 1250, 1150, 1280, 1350, 1420]
                }
              ]
            },
            "styling": {}
          }
        ]
      },
      {
        "slideId": "s04_fail",
        "description": {
          "summary": "This slide presents a complex, non-standard visualization of regional market share.",
          "insight": "While the visual indicates a strong position in North America, the precise data is unclear, warranting a follow-up with a standard chart."
        },
        "elements": [
           {
            "id": "s4-title",
            "type": "text",
            "content": "Market Share Analysis (Conceptual)",
            "x": 100, "y": 80, "w": 900, "h": 50,
            "opacity": 1.0, "class": "pageTitle", "styling": {}
          },
          {
            "id": "s4-chart1",
            "type": "image",
            "x": 100, "y": 150, "w": 1720, "h": 800,
            "opacity": 1.0,
            "imageUrl": "s4-chart-complex.png",
            "dataExtraction": {
              "status": "failed",
              "confidence": 0.15,
              "error": "Complex 3D scatter plot is not supported for data extraction."
            },
            "styling": {}
          }
        ]
      },
      {
        "slideId": "s05_table",
        "description": {
          "summary": "This slide presents a detailed breakdown of revenue by business segment for FY2025 compared to the prior year.",
          "insight": "The Cloud Services segment is the primary growth engine, expanding by nearly 40% YoY and significantly outpacing other segments."
        },
        "elements": [
          {
            "id": "s5-table1",
            "type": "image",
            "x": 100, "y": 150, "w": 1720, "h": 600,
            "opacity": 1.0,
            "imageUrl": "s5-table-segments.png",
            "dataExtraction": {
              "status": "success",
              "confidence": 0.99,
              "error": null
            },
            "tableData": {
              "title": "Revenue by Business Segment (FY2025 vs FY2024, in $M)",
              "headers": ["Segment", "FY2025 Revenue", "FY2024 Revenue", "YoY Growth (%)"],
              "rows": [
                ["Enterprise Solutions", "2500", "2100", "19.0%"],
                ["Consumer Products", "1800", "1750", "2.9%"],
                ["Cloud Services", "900", "650", "38.5%"]
              ],
              "footer": ["Total", "5200", "4500", "15.6%"]
            },
            "styling": {}
          }
        ]
      }
    ]
  }
}